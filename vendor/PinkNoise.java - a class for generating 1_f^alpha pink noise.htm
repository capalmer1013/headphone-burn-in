<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>PinkNoise.java - a class for generating 1/f^alpha pink noise</title>
    <link rel="stylesheet" type="text/css" href="../layout.css" />
    <meta name="keywords" content="PinkNoise.java, pink noise, 1/f, 1/f^alpha, alpha" />
  <meta name="Generator" content="htp 1.16" />
</head>
  <body>
    <div class="body">
      <div class="menu">
	<a href="../index.html">General</a>
	<a href="../contact.html">Contact info</a>
	<a href="../gallery.html">Gallery</a>
	<a href="../software.html">Software</a>
	 <div class="submenu" id="subsoftware">
	  <a href="http://openrocket.sourceforge.net/"><img
	    src="../images/blank.png" alt="" width="9" height="8" />
	    OpenRocket <img src="../images/outside.png" alt="(External link)"
			 title="External link" width="9" height="8" /></a>
	  <a href="../ledcontrol/">Ledcontrol</a>
	  <a href="../switchscreen/">switchscreen</a>
	  <a class="thispage" href="../PinkNoise/">PinkNoise.java</a>
	  <a href="http://www.hut.fi/~pat/cliquer.html"><img
	    src="../images/blank.png" alt="" width="9" height="8" />
	    Cliquer <img src="../images/outside.png" alt="(External link)"
			 title="External link" width="9" height="8" /></a>
	 </div>
	<a href="../LPD/">LPD</a>
	<p>In Finnish:</p>
	<a href="../index.fi.html">Yleistä</a>
	<a href="../larppaus.html">Larppaus</a>
	<a href="../links.html">Linkkejä</a>
      </div>
      <div class="main">
	<h1>PinkNoise.java</h1>
	<p class="subheading center">A class for generating
1/f<sup>&alpha;</sup> <span class="invisible">(1/f^alpha)</span> pink noise</p>
	<hr />
	<h2>Pink noise primer</h2>
	
	<p>Pink noise is a sequence of random numbers that have a
specific form of frequency spectrum.  Specifically, the power spectrum
density (PSD) of the noise is proportional to 1/f<sup>&alpha;</sup>,
where f is the frequency and 0&nbsp;&lt;&nbsp;&alpha;&nbsp;&lt;&nbsp;2.
"Normal" pink noise has the parameter value &alpha;=1, but in many
physical systems noise appears with different exponent values.</p>
	<p>A more thorough explanation of pink noise is available on
<a href="http://en.wikipedia.org/wiki/Pink_noise">Wikipedia</a> and
on the page <a href="http://www.firstpr.com.au/dsp/pink-noise/">DSP
generation of Pink (1/f) Noise</a>.</p>
	<h2>Methodology</h2>
	<p>In a recent project I required code that generated
1/f<sup>5/3</sup> pink noise.  The
<a href="http://www.firstpr.com.au/dsp/pink-noise/">DSP generation of
Pink (1/f) Noise</a> page contains several pieces of code that
generate 1/f pink noise, but I was unable to find any simple code that
would allow specification of the exponent parameter &alpha;.  I
therefore wrote a new Java class for the purpose, and placed it here
so others may benefit from it as well.</p>
	<p>The class generates the noise by filtering white noise
(plain pseudorandom numbers) with an infinite
impulse response (IIR) filter.  The filter is described by
<a href="http://ieeexplore.ieee.org/xpl/articleDetails.jsp?arnumber=381848">
N. Jeremy Kasdin, <em>Proceedings of the IEEE</em>, Vol. 83, No. 5,
May 1995</a>, p. 822 equation (116).</p>
	<p>The filter generates a pink noise sample
<em>x<sub>n</sub></em> from a white noise sample
<em>w<sub>n</sub></em> using the formula</p>
	<p class="math">x<sub>n</sub> = w<sub>n</sub>
	- a<sub>1</sub> x<sub>n-1</sub>
	- a<sub>2</sub> x<sub>n-2</sub>
	- a<sub>3</sub> x<sub>n-3</sub> - ...</p>
	<p>where the coefficients are computed using</p>
	<p class="math">a<sub>0</sub> = 1 <br />
	a<sub>k</sub> = (k - 1 - &alpha;/2) a<sub>k-1</sub> / k</p>
	<p>This infinite sum is truncated with some number of terms,
or <em>poles</em>.  It was discovered that already 1&ndash;3 poles
yield a good power spectrum at higher frequencies (read further for
the properties and effect of the number of poles).</p>
	<h2>Properties of the generated sequence</h2>
	<p>Since the IIR filter must be truncated, the power spectrum
becomes constant below some limiting frequency.  This limiting
frequency is dependent on the number of poles used; the more poles are
used the more low frequency components are included.  A small number of
poles results in noise centered at zero, while a large number of poles
will have low frequency components and the sequence may deviate from
zero for a long time.  However, as any pink noise generated by
filtering white noise, <em>the resulting pink noise sequence is
stationary</em>, while true pink noise is non-stationary.  This means
that eventually the sequence will always return to zero.  For most
applications this is acceptable and even desirable, but some
applications may require other generation techniques.</p>
	<p>Below is a plot of two sequences of pink noise generated
from the same random number sequence with two and twenty poles.  This
shows the qualitative difference that the number of poles has.  The
second figure shows the average power spectrum density of one hundred
generated pink noise sequences with two, five and twenty IIR poles.
The more poles are used, the lower the limiting frequency is.</p>
	<p>The distribution of the values is very close to Gaussian
with zero mean.  However, the standard deviation is dependent on the
number of poles used.  In order to normalize the values to standard
deviation one, generate a long sequence of pink noise with the same
pole amount, calculate its standard deviation, and divide the
generated samples by that value.  Below is a histogram of a generated
pink noise sequence with five poles, normalized to standard deviation
one, along with the density function of the normal distribution.  The
two distributions are very close to one another.</p>
	<p>
<a href="timeplot.png"><img src="timeplot-small.png" alt="A plot of
two generated pink noise sequences with two and twenty poles." /></a>
&nbsp;&nbsp;
<a href="PSD.png"><img src="PSD-small.png" alt="The average power
spectrum of generated pink noise sequences with two, five and twenty
poles." /></a>
&nbsp;&nbsp;
<a href="histogram.png"><img src="histogram-small.png" alt="Histogram
of a generated pink noise sequence and the normal distribution density
function." /></a> <br />
<span class="note"><em>Click on a figure for a larger version.</em></span>
</p>
	<hr />
	<h2>Usage</h2>
	<p><tt>PinkNoise.java</tt> contains three constructors.  The
most general constructor allows defining the parameter &alpha;, the
number of IIR poles to use and the <tt>Random</tt> object that will be
used as a randomness source.  The constructors with fewer arguments
use the default values of &alpha;=1.0, 5 poles and a no-argument
<tt>Random</tt> object.</p>
	<p>The class supports generating pink noise for any
0&nbsp;&le;&nbsp;&alpha;&nbsp;&le;&nbsp;2.  The special case &alpha;=0
corresponds to white noise (simple random numbers) and &alpha;=2
generates brown noise (integrated white noise).</p>
	<p>After construction pink noise samples may be generated
using the method <tt>nextValue()</tt>.  The resulting values will be
very close to the normal distribution with mean zero, but the standard
deviation will be dependent on the number of poles used (see
above).</p>
	<p>The class also contains a <tt>main</tt> method, which
demonstrates the usage and allows generating pink noise values from
the command line.</p>
	<p>For futher information, see the
<a href="PinkNoise.html">JavaDoc of <tt>PinkNoise.java</tt></a>.</p>
	<h2>License</h2>
	<p><tt>PinkNoise.java</tt> is licensed under the
<a href="http://www.opensource.org/licenses/bsd-license.php">BSD
license</a>.  Basically all use is allowed as long as the copyright
notice is included.</p>
	<h2>Download</h2>
	<p><strong>Source:</strong>
	  <a href="PinkNoise.java">PinkNoise.java</a>
	</p>
	
	<h2>Contact</h2>
	<p>I would really like to hear if you found
<tt>PinkNoise.java</tt> useful.  You can send comments to
<span class="email">sampo<span>.niskanen</span><span>@<span class="invisible">removethis.</span>ik</span>i<span>.fi</span></span>.</p>
	
      </div>
      <div id="footer">
	<div class="url"><a href="http://www.iki.fi/sampo.niskanen/PinkNoise/">http://www.iki.fi/sampo.niskanen/PinkNoise/</a></div>
	<p>&copy; Sampo Niskanen
	<span class="email">&lt;<a href="../contact.html" title="Contact information">sampo<span>.niskanen</span><span>@<span class="invisible">removethis.</span>ik</span>i<span>.fi</span></a>&gt;</span></p>
      </div>
    </div>
    <div id="valid">
      <p><a href="http://validator.w3.org/check/referer"><img
	  src="http://www.w3.org/Icons/valid-xhtml10"
          alt="Valid XHTML 1.0!" /></a>
	 <a href="http://jigsaw.w3.org/css-validator/check/referer"><img
	  src="http://jigsaw.w3.org/css-validator/images/vcss"
	  alt="Valid CSS!" /></a>
      </p>
    </div>
  </body>
</html>
